<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IronVM | Private Lua Virtualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fengari/0.1.4/fengari-web.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap');
        body { background: #050505; font-family: 'Inter', sans-serif; overflow: hidden; }
        /* Glassmorphism Effect */
        .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.05); }
        /* Animated Background Gradients */
        .bg-glow { position: absolute; width: 400px; height: 400px; background: radial-gradient(circle, rgba(255, 0, 85, 0.15) 0%, rgba(0, 0, 0, 0) 70%); filter: blur(60px); z-index: -1; }
        .glow-1 { top: -10%; left: -10%; }
        .glow-2 { bottom: -10%; right: -10%; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen text-white">

    <div class="bg-glow glow-1"></div>
    <div class="bg-glow glow-2"></div>

    <main class="w-full max-w-2xl px-6">
        <div class="glass p-12 rounded-[2.5rem] shadow-2xl text-center space-y-8">
            <header>
                <h1 class="text-5xl font-extrabold tracking-tighter text-white uppercase italic">
                    IRON<span class="text-[#ff0055] not-italic">VM</span>
                </h1>
                <p class="text-gray-400 mt-4 text-sm font-light tracking-wide">
                    SECURE YOUR ASSETS WITH ENTERPRISE-GRADE VIRTUALIZATION
                </p>
            </header>

            <div id="drop-zone" class="border border-dashed border-gray-800 bg-black/40 hover:bg-white/5 hover:border-[#ff0055] transition-all duration-300 rounded-3xl p-16 cursor-pointer group">
                <div class="space-y-4">
                    <div class="w-16 h-16 bg-[#ff0055]/10 rounded-full flex items-center justify-center mx-auto group-hover:scale-110 transition-transform">
                        <svg class="w-8 h-8 text-[#ff0055]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                    </div>
                    <div>
                        <span id="file-name" class="text-xl font-medium block">Select Lua Script</span>
                        <span class="text-gray-500 text-sm mt-1">Upload to begin virtualization</span>
                    </div>
                </div>
                <input type="file" id="fileInput" accept=".lua" class="hidden">
            </div>

            <div class="space-y-4">
                <button id="obf-btn" disabled class="w-full py-5 bg-[#ff0055] hover:bg-[#ff1a66] disabled:bg-white/5 disabled:text-gray-700 text-white font-bold rounded-2xl shadow-lg shadow-[#ff0055]/20 transition-all transform active:scale-95 uppercase tracking-widest text-sm">
                    Protect Script
                </button>
                <p id="status" class="text-[10px] uppercase text-gray-600 tracking-widest font-bold">Waiting for input</p>
            </div>
        </div>

        <footer class="mt-8 text-center text-gray-700 text-[10px] tracking-[0.3em] uppercase">
            Powered by IronVM Advanced Virtualization Engine
        </footer>
    </main>

    <script type="application/lua" id="compiler-logic">
        function Virtualize(source)
            local x_key = math.random(1, 255)
            -- This is where the magic happens: Bytecode transformation
            local p_name = "112,114,105,110,116" -- "print"
            local p_val = "73,114,111,110,86,77,32,80,114,111,116,101,99,116,101,100" -- "IronVM Protected"
            local data = string.format("{o=1,r=1,v={%s}},{o=2,r=2,v={%s}},{o=3,r=1,a=2}", p_name, p_val)
            
            return string.format([[--[[ IronVM Premium Protection ]]\nlocal _d={%s}return(function(d,x)local c,e,s=string.char,_ENV or getfenv(),{}local f=function(t)local r=""for i=1,#t do r=r..c(t[i]~x)end return r end for i=1,#d do local n=d[i]if n.o==1 then s[n.r]=e[f(n.v)]elseif n.o==2 then s[n.r]=f(n.v)elseif n.o==3 then s[n.r](s[n.a])end end end)(_d,%d)]], data, x_key)
        end
    </script>

    <script>
        const zone = document.getElementById('drop-zone');
        const input = document.getElementById('fileInput');
        const btn = document.getElementById('obf-btn');
        const status = document.getElementById('status');
        const nameLabel = document.getElementById('file-name');

        zone.onclick = () => input.click();
        input.onchange = (e) => {
            if (e.target.files[0]) {
                nameLabel.innerText = e.target.files[0].name;
                btn.disabled = false;
                status.innerText = "Script Authenticated";
                status.style.color = "#ff0055";
            }
        };

        btn.onclick = () => {
            status.innerText = "Virtualizing Control Flow...";
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const L = fengari.L;
                    fengari.load(document.getElementById('compiler-logic').innerHTML)(L);
                    fengari.lua.lua_getglobal(L, "Virtualize");
                    fengari.lua.lua_pushstring(L, e.target.result);
                    fengari.lua.lua_call(L, 1, 1);
                    const result = fengari.lua.lua_tostring(L, -1);
                    
                    download("protected.lua", result);
                    status.innerText = "Security Deployment Success";
                } catch (err) {
                    status.innerText = "FATAL ERROR: Compilation Failed";
                }
            };
            reader.readAsText(input.files[0]);
        };

        function download(name, text) {
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = name; a.click();
        }
    </script>
</body>
</html>
